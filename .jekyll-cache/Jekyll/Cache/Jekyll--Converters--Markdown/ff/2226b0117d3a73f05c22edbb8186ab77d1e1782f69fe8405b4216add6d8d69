I"š"<p>ì°¸ê³ ìë£Œ <br />
<a href="https://github.com/ll0301/architecture-samples/tree/todo-mvvm-live-kotlin">https://github.com/ll0301/architecture-samples/tree/todo-mvvm-live-kotlin</a>
<a href="https://two22.tistory.com/12">https://two22.tistory.com/12</a></p>

<p>ì´ì „ì— ë§Œë“¤ì—ˆë˜ introActivityë¥¼ testí•´ë³´ì.</p>
<h2 id="buildgradlemoduleapp">build.gradle(Module:app)</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    // local unit test
    testImplementation 'androidx.test.ext:junit:1.1.2'

    // android unit test
    androidTestImplementation 'androidx.test.ext:junit:1.1.2'

    // android ui test
    androidTestImplementation 'androidx.test:runner:1.3.0'
    androidTestImplementation 'androidx.test:rules:1.3.0'
    androidTestImplementation 'androidx.test.espresso:espresso-core:3.3.0'
    androidTestImplementation 'androidx.test.espresso:espresso-contrib:3.3.0'
    androidTestImplementation 'androidx.test.espresso:espresso-intents:3.3.0'
    androidTestImplementation 'androidx.test.espresso.idling:idling-concurrent:3.3.0'
    implementation 'androidx.test.espresso:espresso-idling-resource:3.3.0'
</code></pre></div></div>
<ul>
  <li>Junit =&gt; Javaì˜ ëŒ€í‘œì ì¸ Testing Framework
    <ul>
      <li>java ì´ì™¸ì—ë„ ê°ê°ì˜ ì–¸ì–´ì— í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ê°€ ìˆë‹¤. (CUnit, PyUnit â€¦)</li>
      <li>ë˜‘ê°™ì€ junitì´ testImplementationê³¼ androidTestImplementationìœ¼ë¡œ ì¶”ê°€ë˜ì–´ ìˆëŠ” ì´ìœ 
        <ul>
          <li>app/srcì—ëŠ” main / test / androidTest íŒ¨í‚¤ì§€ë¡œ ë‚˜ë‰˜ì–´ì ¸ ìˆë‹¤.
            <ul>
              <li>main =&gt; ì‹¤ì œ ë™ì‘í•˜ëŠ” ì½”ë“œ</li>
              <li>test =&gt; unit testë¥¼ êµ¬í˜„í•œ ì½”ë“œ</li>
              <li>androidTest =&gt; ui testë¥¼ êµ¬í˜„í•œ ì½”ë“œ (í™”ë©´í„°ì¹˜, í‘œì‹œë‚´ìš© ë“± )
                <ul>
                  <li>testImplementation =&gt; test ì†ŒìŠ¤ ì„¸íŠ¸ì— ëŒ€í•œ ì¢…ì†ì„± ì¶”ê°€</li>
                  <li>androidTestImplementation =&gt; androidTest ì†ŒìŠ¤ ì„¸íŠ¸ì— ëŒ€í•œ ì¢…ì†ì„± ì¶”ê°€</li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li>runner
    <ul>
      <li>ui test ê´€ë ¨ëœ espresso ë° ui automator í”„ë ˆì„ì›Œí¬ë¥¼ ì‹¤í–‰</li>
      <li>Junit í…ŒìŠ¤íŠ¸ í´ë˜ìŠ¤ë¥¼ ì‹¤í–‰</li>
    </ul>
  </li>
  <li>rules
    <ul>
      <li>Junit ê·œì¹™ ì…‹</li>
      <li>í…ŒìŠ¤íŠ¸ì— í•„ìš”í•œ ìƒìš©êµ¬ ì½”ë“œë¥¼ ì¤„ì´ê³  ìœ ì—°ì„±ì„ ë†’ì„</li>
    </ul>
  </li>
  <li>espresso-core   / epresso-contrib / espresso-intents  / idling-concurrent / idling-resource
    <ul>
      <li>ì•ˆë“œë¡œì´ë“œì—ì„œ ui testë¥¼ ìœ„í•´ ëŒ€í‘œì ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬</li>
      <li>core =&gt; espressoì˜ ê¸°ë³¸ ë©”ì†Œë“œê°€ ë‹´ê¸´ íŒ¨í‚¤ì§€</li>
      <li>contrilb =&gt; DatePicker, RecyclerView, Drawer ë“±ì„ ì§€ì› í•˜ëŠ” íŒ¨í‚¤ì§€</li>
      <li>intents =&gt; íì‡„ì  í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•œ ì¸í„´íŠ¸ í™•ì¥ì´ ë‹´ê¸´ íŒ¨í‚¤ì§€</li>
      <li>idling
        <ul>
          <li>ì–´ë– í•œ uiì˜ ë™ì‘ì„ í…ŒìŠ¤íŠ¸í•  ë•Œ íŠ¹ì • ë™ì‘ì˜ ì™„ë£Œë¥¼ ê¸°ë‹¤ë ¤ì•¼í•˜ëŠ” ìƒí™©ì—ì„œ EspressoëŠ” í•´ë‹¹ ì‘ì—…ì˜ ì¢…ë£Œë¥¼ ê¸°ë‹¤ë¦¬ëŠ” ë°©ë²•ì„ ëª¨ë¦„</li>
          <li>idlingì„ ì‘ì„±í•˜ì—¬ Espressoê°€ ëŒ€ê¸°í•  ìˆ˜ ìˆë„ë¡ í•¨</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<h2 id="androidtestintroscreentestkt">(androidTest)IntroScreenTest.kt</h2>
<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>@RunWith(AndroidJUnit4::class)
@LargeTest
class IntroScreenTest {
...
}
</code></pre></div></div>
<ul>
  <li>@RunWith(AndroidJUnit4::class)
    <ul>
      <li>í•´ë‹¹ í´ë˜ìŠ¤ê°€ Test í´ë˜ìŠ¤ì„ì„ ëª…ì‹œ</li>
    </ul>
  </li>
  <li>@LargeTest
    <ul>
      <li>ì™¸ë¶€ íŒŒì¼ ì‹œìŠ¤í…œ, ë„¤íŠ¸ì›Œí¬ ë“±ì— ì•¡ì„¸ìŠ¤í•  ìˆ˜ ìˆìŒ</li>
      <li>@SmallTest =&gt; íŒŒì¼ì‹œìŠ¤í…œì´ë‚˜ ë„¤íŠ¸ì›Œí¬ì™€ ìƒí˜¸ì‘ìš©í•˜ì§€ ì•ŠìŒ</li>
      <li>@Medium =&gt; localhostë§Œ ì•¡ì„¸ìŠ¤</li>
    </ul>
  </li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    @get: Rule
    var activityScenarioRule: ActivityScenarioRule&lt;IntroActivity&gt; =
        ActivityScenarioRule(
            Intent(
                ApplicationProvider.getApplicationContext(),
                IntroActivity::class.java
            ).apply { putExtra("MyArgs", "Nothing") })
</code></pre></div></div>
<ul>
  <li>@get:Rule
    <ul>
      <li>ActivityScenarioRuleì„ ì‚¬ìš©í•˜ê¸° ìœ„í•¨</li>
      <li>Testing  ì§„í–‰í•  activityë¥¼ ì—°ê²°</li>
    </ul>
  </li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    @Before
    fun setUp() {
        activityScenarioRule.scenario.onActivity { it -&gt;
            (it.findViewById&lt;ConstraintLayout&gt;(R.id.intro_cl))?.let {
            
            }
            (it.findViewById&lt;TextView&gt;(R.id.intro_logo))?.let {
                // it.text = "ChangeUI"
            }
        }
    }
    
    @After
    fun close() {
        activityScenarioRule.scenario.close()
    }
</code></pre></div></div>
<ul>
  <li>@Before
    <ul>
      <li>í…ŒìŠ¤íŠ¸ ì´ì „ì— ì‹¤í–‰ ë¨</li>
    </ul>
  </li>
  <li>@After
    <ul>
      <li>í…ŒìŠ¤íŠ¸ ì´í›„ì— ì‹¤í–‰ ë¨</li>
    </ul>
  </li>
  <li>ActivityScenarioRule.scenario
    <ul>
      <li>ë¡œì»¬ ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ë° ê¸°ê¸° ë‚´ í†µí•© í…ŒìŠ¤íŠ¸ì—ì„œ ëª¨ë‘ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” í¬ë¡œìŠ¤ í”Œë«í¼ API ì´ë‹¤.</li>
      <li>í…ŒìŠ¤íŠ¸ ê³„ì¸¡ ìŠ¤ë ˆë“œì™€ í…ŒìŠ¤íŠ¸ì‹¤í–‰ ìŠ¤ë ˆë“œë¥¼ ë™ê¸°í™”í•œë‹¤.</li>
      <li>onActivity { } ë‚´ë¶€ì— ì—°ê²°ëœ activityì˜ xml view ë“¤ì„ ì°¾ì•„ì„œ ì—°ê²°í•  ìˆ˜ ìˆë‹¤.</li>
      <li>í…ŒìŠ¤íŠ¸ì—ì„œ ê¸€ìì…ë ¥ í˜¹ì€ í´ë¦­ë“±ì´ í•„ìš”í•œê²½ìš° ì…‹íŒ…í•  ìˆ˜ ìˆìŒ</li>
    </ul>
  </li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    @Test
    fun resultTest() {
        activityScenarioRule.scenario.onActivity {
            it.setResult(Activity.RESULT_OK, Intent().apply { putExtra("Result", "Ok") })
            it.finish()
        }
        Assert.assertEquals(activityScenarioRule.scenario.result.resultCode, Activity.RESULT_OK)
        val result = activityScenarioRule.scenario.result.resultData?.extras?.getString("Result")
        Assert.assertEquals(result, "Ok")
    }
</code></pre></div></div>
<ul>
  <li>@Test
    <ul>
      <li>í•´ë‹¹ í•¨ìˆ˜ê°€ í…ŒìŠ¤íŠ¸ìš© í•¨ìˆ˜ì„ì„ ë‚˜íƒ€ëƒ„</li>
    </ul>
  </li>
  <li>ActivityScenarioRule.scenario.onActivity {}
    <ul>
      <li>í…ŒìŠ¤íŠ¸ ì‹œ ì²´í¬í•  ì‚¬í•­ë“¤ì„ êµ¬í˜„í•  ìˆ˜ ìˆìŒ</li>
    </ul>
  </li>
  <li>Assert
    <ul>
      <li>í…ŒìŠ¤íŠ¸ì˜ ìˆ˜í–‰ê²°ê³¼ë¥¼ íŒë³„í•˜ëŠ”ë° ì‚¬ìš©í•œë‹¤.</li>
      <li>assertEquals(a,b) =&gt; ì…ë ¥ëœ a,b ê°€ ì¼ì¹˜í•˜ëŠ”ì§€ í™•ì¸
        <ul>
          <li>ì´ ì™¸ì—ë„ assertFalse() , assertNotNull(), assertFail() ë“±ì˜ ë©”ì†Œë“œê°€ ìˆìŒ</li>
        </ul>
      </li>
    </ul>
  </li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>    @Test
    fun moveToStateTest() {
        activityScenarioRule.scenario?.let {
            it.moveToState(Lifecycle.State.STARTED)
            Assert.assertEquals(it.state, Lifecycle.State.STARTED)
            it.moveToState(Lifecycle.State.CREATED)
            Assert.assertEquals(it.state, Lifecycle.State.CREATED)
            it.moveToState(Lifecycle.State.RESUMED)
            Assert.assertEquals(it.state, Lifecycle.State.RESUMED)
            it.moveToState(Lifecycle.State.DESTROYED)
            Assert.assertEquals(it.state, Lifecycle.State.DESTROYED)
            // activityScenario.recreate()
        }
    }
</code></pre></div></div>
<ul>
  <li>moveToStae()
    <ul>
      <li>ì•¡í‹°ë¹„í‹°ì˜ ë¼ì´í”„ ì‚¬ì´í´ì„ ì„ì˜ë¡œ ë³€ê²½í•  ìˆ˜ ìˆìŒ</li>
      <li>í˜„ì¬ìƒíƒœë¥¼ Lifecycle.State ë³€ìˆ˜ë¥¼ í†µí•´ í™•ì¸ê°€ëŠ¥</li>
      <li>recreate ë©”ì†Œë“œë¥¼ ì´ìš©í•˜ë©´ ì•±ì„ onSaveInstanceStateì™€ í•¨ê»˜ ì¬ì‹¤í–‰í•  ìˆ˜ ìˆìŒ</li>
    </ul>
  </li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>lateinit var activityScenario: ActivityScenario&lt;IntroActivity&gt;
    
    @Before
    fun setUp() {
        activityScenario = ActivityScenario.launch(
            Intent(
                ApplicationProvider.getApplicationContext(),
                IntroActivity::class.java
            ).apply {
                putExtra("MyArgs", "Nothing")
            })
        
        activityScenario.onActivity {
            (it.findViewById&lt;ConstraintLayout&gt;(R.id.intro_cl))?.let {
            
            }
        }
    }
</code></pre></div></div>
<ul>
  <li>ActivityScenarioë§Œ ë‹¨ë…ìœ¼ë¡œ ì‚¬ìš© ê°€ëŠ¥</li>
</ul>
:ET